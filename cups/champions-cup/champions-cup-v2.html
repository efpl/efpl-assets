<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>eFPL ‚Äî Champions Cup</title>
<style>
  :root{
    --bg:#00143b; --card:#05225a; --ink:#fff; --muted:#cbd5e1;
    --accent:#f9d71c; --line:rgba(249,215,28,.45);
  }
  html,body{background:transparent}
  body{margin:0;font:16px/1.5 system-ui,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink)}
  .wrap{max-width:1160px;margin:24px auto;padding:16px;background:var(--bg);border-radius:14px}

  /* Title */
  .title{display:flex;justify-content:center;align-items:center;gap:10px;margin:0 0 16px}
  .title h1{margin:0;font-size:clamp(22px,4.5vw,30px);font-weight:900}
  .eyebrow{background:var(--accent);color:#0b1b3d;padding:2px 10px;border-radius:999px;font-weight:900;font-size:12px}

  /* 3 columns: left / center / right */
  .stage{display:grid;grid-template-columns:1fr auto 1fr;gap:12px;align-items:start}

  /* Sides with stepped rounds */
  .side{display:grid;gap:12px}
  .group{display:grid;gap:10px}
  .group h3{
    position:relative;
    margin:0 0 6px;
    font-size:12px;
    letter-spacing:.12em;
    text-transform:uppercase;
    color:var(--muted);
    text-align:center;
    padding-bottom:8px;
  }
  .group h3::after{
    content:"";
    position:absolute;
    left:50%;
    transform:translateX(-50%);
    bottom:0;
    width:120px;
    height:3px;
    background:linear-gradient(90deg, rgba(249,215,28,0), var(--accent), rgba(249,215,28,0));
    border-radius:999px;
    opacity:.9;
  }

  /* Match cards */
  .match{background:var(--card);border:1px solid var(--line);border-radius:10px;padding:10px 12px;min-width:210px;box-shadow:0 2px 6px rgba(0,0,0,.2)}
  .fixture{
    display:grid;
    grid-template-columns:1fr auto 1fr;
    align-items:center;
    gap:8px;
    font-weight:800;
  }
  .team{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
  .team.right{text-align:right}
  .vs{opacity:.85;font-weight:900}

  /* Route caption */
  .path{
    margin-top:6px;
    font-size:11px;
    line-height:1.2;
    color:var(--muted);
    text-align:center;
    letter-spacing:.02em;
  }

  /* Stepping toward center */
  .left  .r16{margin-right:70px} .left  .qf{margin-right:35px} .left  .sf{margin-right:0}
  .right .r16{margin-left:70px} .right .qf{margin-left:35px} .right .sf{margin-left:0}

  /* Connector bars pointing inward */
  .left  .match::after {content:"";display:block;height:0;border-top:2px solid var(--line);margin-left:auto;width:24px;transform:translateY(8px)}
  .left  .qf .match::after{width:34px} .left  .sf .match::after{width:44px}
  .right .match::before{content:"";display:block;height:0;border-top:2px solid var(--line);margin-right:auto;width:24px;transform:translateY(8px)}
  .right .qf .match::before{width:34px} .right .sf .match::before{width:44px}

  /* Center column (trophy + final + champion) */
  .center{display:flex;flex-direction:column;align-items:center;gap:14px;padding:8px 0}
  .center h3{
    position:relative;
    margin:0 0 6px;
    font-size:12px;
    letter-spacing:.12em;
    text-transform:uppercase;
    color:var(--muted);
    text-align:center;
    padding-bottom:8px;
  }
  .center h3::after{
    content:"";
    position:absolute;
    left:50%;
    transform:translateX(-50%);
    bottom:0;
    width:140px;
    height:3px;
    background:linear-gradient(90deg, rgba(249,215,28,0), var(--accent), rgba(249,215,28,0));
    border-radius:999px;
    opacity:.9;
  }
  .trophy{width:min(240px,32vw);height:auto;object-fit:contain;filter:drop-shadow(0 10px 28px rgba(0,0,0,.45))}
  .final{background:var(--accent);color:#0b1b3d;font-weight:900;border-radius:12px;padding:12px 16px;text-align:center;min-width:240px;border:2px solid #fff}
  .champion{background:linear-gradient(180deg,var(--accent),#e8c617);color:#0b1b3d;font-weight:900;text-align:center;border-radius:14px;padding:16px 22px;border:2px solid #fff;box-shadow:0 8px 24px rgba(0,0,0,.35)}
  .champion .cup{font-size:22px;margin-right:6px}
  .note{color:#cbd5e1;font-size:12px;text-align:center}
  @media (max-width:860px){
    .wrap{padding:12px}
    .stage{grid-template-columns:1fr;gap:12px}
    .center{order:-1}
    .left .r16,.left .qf,.left .sf,.right .r16,.right .qf,.right .sf{margin:0}
    .left .match::after,.right .match::before{display:none}
    .match{min-width:auto}
    .final{min-width:auto;width:100%}
    .champion{width:100%}
    .stack h2{text-align:center;color:var(--accent);margin:12px 0 6px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="title">
      <span class="eyebrow">Champions Cup</span>
      <h1>Road to the Final</h1>
    </div>

    <div class="stage">
      <!-- LEFT -->
      <div class="side left">
        <div class="group r16">
          <h3>Round of 16</h3>

          <div class="match">
            <div class="fixture"><span class="team" id="R16A-home">Team 1</span><span class="vs" id="R16A-score">vs</span><span class="team right" id="R16A-away">Team 2</span></div>
            <div class="path">Match 1</div>
          </div>

          <div class="match">
            <div class="fixture"><span class="team" id="R16B-home">Team 3</span><span class="vs" id="R16B-score">vs</span><span class="team right" id="R16B-away">Team 4</span></div>
            <div class="path">Match 2</div>
          </div>

          <div class="match">
            <div class="fixture"><span class="team" id="R16C-home">Team 5</span><span class="vs" id="R16C-score">vs</span><span class="team right" id="R16C-away">Team 6</span></div>
            <div class="path">Match 3</div>
          </div>

          <div class="match">
            <div class="fixture"><span class="team" id="R16D-home">Team 7</span><span class="vs" id="R16D-score">vs</span><span class="team right" id="R16D-away">Team 8</span></div>
            <div class="path">Match 4</div>
          </div>
        </div>

        <div class="group qf">
          <h3>Quarter-finals (1 & 2)</h3>
          <div class="match">
            <div class="fixture"><span class="team" id="Q1-home">Winner A</span><span class="vs" id="Q1-score">vs</span><span class="team right" id="Q1-away">Winner B</span></div>
            <div class="path" id="Q1-path">Winners of Matches 1 & 2</div>
          </div>
          <div class="match">
            <div class="fixture"><span class="team" id="Q2-home">Winner C</span><span class="vs" id="Q2-score">vs</span><span class="team right" id="Q2-away">Winner D</span></div>
            <div class="path" id="Q2-path">Winners of Matches 3 & 4</div>
          </div>
        </div>

        <div class="group sf">
          <h3>Semi-final (1)</h3>
          <div class="match">
            <div class="fixture"><span class="team" id="S1-home">Winner Q1</span><span class="vs" id="S1-score">vs</span><span class="team right" id="S1-away">Winner Q2</span></div>
            <div class="path" id="S1-path">Winners of Quarter-finals 1 & 2</div>
          </div>
        </div>
      </div>

      <!-- CENTER -->
      <div class="center">
        <h3>Final</h3>
        <img class="trophy" alt="Champions Cup Trophy" src="https://efpl-assets.pages.dev/img/champions-cup.png" />
        <div class="final" id="final-line">Final: Winner S1 vs Winner S2</div>
        <div class="note" id="final-path">Winners of both Semi-finals</div>
        <div class="champion" id="champion"><span class="cup">üèÜ</span> Champion: TBD</div>
      </div>

      <!-- RIGHT -->
      <div class="side right">
        <div class="group r16">
          <h3>Round of 16</h3>

          <div class="match">
            <div class="fixture"><span class="team" id="R16E-home">Team 9</span><span class="vs" id="R16E-score">vs</span><span class="team right" id="R16E-away">Team 10</span></div>
            <div class="path">Match 5</div>
          </div>

          <div class="match">
            <div class="fixture"><span class="team" id="R16F-home">Team 11</span><span class="vs" id="R16F-score">vs</span><span class="team right" id="R16F-away">Team 12</span></div>
            <div class="path">Match 6</div>
          </div>

          <div class="match">
            <div class="fixture"><span class="team" id="R16G-home">Team 13</span><span class="vs" id="R16G-score">vs</span><span class="team right" id="R16G-away">Team 14</span></div>
            <div class="path">Match 7</div>
          </div>

          <div class="match">
            <div class="fixture"><span class="team" id="R16H-home">Team 15</span><span class="vs" id="R16H-score">vs</span><span class="team right" id="R16H-away">Team 16</span></div>
            <div class="path">Match 8</div>
          </div>
        </div>

        <div class="group qf">
          <h3>Quarter-finals (3 & 4)</h3>
          <div class="match">
            <div class="fixture"><span class="team" id="Q3-home">Winner E</span><span class="vs" id="Q3-score">vs</span><span class="team right" id="Q3-away">Winner F</span></div>
            <div class="path" id="Q3-path">Winners of Matches 5 & 6</div>
          </div>
          <div class="match">
            <div class="fixture"><span class="team" id="Q4-home">Winner G</span><span class="vs" id="Q4-score">vs</span><span class="team right" id="Q4-away">Winner H</span></div>
            <div class="path" id="Q4-path">Winners of Matches 7 & 8</div>
          </div>
        </div>

        <div class="group sf">
          <h3>Semi-final (2)</h3>
          <div class="match">
            <div class="fixture"><span class="team" id="S2-home">Winner Q3</span><span class="vs" id="S2-score">vs</span><span class="team right" id="S2-away">Winner Q4</span></div>
            <div class="path" id="S2-path">Winners of Quarter-finals 3 & 4</div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
(function(){
  const SHEET_ID = "1l-JRipmpDXnQXK7XuJY8k3TLELfsSQ_Q-kcUJzy9du8"; // your sheet
  const GID = "0"; // Cup Bracket tab
  const tq = "select A,B,C,D,E,F,G,H,I,J where A is not null";
  const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?gid=${GID}&tqx=out:json&tq=`+
              encodeURIComponent(tq)+`&cachebust=`+Date.now();

  function keyByIndex(i){
    if (i >= 0 && i <= 7)  { const L=["A","B","C","D","E","F","G","H"]; return "R16"+L[i]; }
    if (i >= 8 && i <= 11) return "Q"+(i-7);
    if (i >= 12 && i <= 13) return "S"+(i-11);
    if (i === 14)          return "F1";
    return "";
  }

  function setPathCaptions(){
    const map = {
      "Q1-path":"Winners of Matches 1 & 2",
      "Q2-path":"Winners of Matches 3 & 4",
      "Q3-path":"Winners of Matches 5 & 6",
      "Q4-path":"Winners of Matches 7 & 8",
      "S1-path":"Winners of Quarter-finals 1 & 2",
      "S2-path":"Winners of Quarter-finals 3 & 4",
      "final-path":"Winners of both Semi-finals"
    };
    Object.entries(map).forEach(([id,text])=>{
      const el=document.getElementById(id);
      if(el) el.textContent=text;
    });
  }
  setPathCaptions();

  fetch(url).then(r=>r.text()).then(t=>{
    const json = JSON.parse(t.substring(t.indexOf('{'), t.lastIndexOf('}')+1));
    const rows = (json.table && json.table.rows) ? json.table.rows : [];

    let finalText = "Final: Winner S1 vs Winner S2";
    let championText = "üèÜ Champion: TBD";

    rows.forEach((row, i) => {
      const [round, slot, home, away, hs, as, done, winner, method, note] =
            row.c.map(c => c ? c.v : "");
      const key = keyByIndex(i);
      if (!key) return;

      const elHome  = document.getElementById(`${key}-home`);
      const elAway  = document.getElementById(`${key}-away`);
      const elScore = document.getElementById(`${key}-score`);

      if (elHome) elHome.textContent = home || "TBD";
      if (elAway) elAway.textContent = away || "TBD";

      const hasScore = done === true && hs !== "" && as !== "" && !isNaN(+hs) && !isNaN(+as);

      // Build AET / pens tag
      let tag = "";
      if (method === "AET") {
        tag = " AET";
      } else if (method === "Pens") {
        const m = /(\d+)\s*-\s*(\d+)/i.exec(note || "");
        if (m && winner) {
          tag = ` (${winner} wins ${m[1]}-${m[2]} on pens)`;
        } else {
          tag = " (pens)";
        }
      }

      if (elScore) {
        elScore.textContent = hasScore ? `${hs} - ${as}${tag}` : "vs";
      }

      // Final line + Champion
      if (key === "F1") {
        const h = home || "Winner S1";
        const a = away || "Winner S2";
        let finalTag = "";
        if (method === "AET") {
          finalTag = " AET";
        } else if (method === "Pens") {
          const m = /(\d+)\s*-\s*(\d+)/i.exec(note || "");
          if (m && winner) {
            finalTag = ` (${winner} wins ${m[1]}-${m[2]} on pens)`;
          } else {
            finalTag = " (pens)";
          }
        }
        finalText = hasScore ? `Final: ${h} ${hs} - ${as} ${a}${finalTag}` : `Final: ${h} vs ${a}`;
        if (hasScore && winner) championText = `üèÜ Champion: ${winner}`;
      }
    });

    const finalEl = document.getElementById("final-line");
    if (finalEl) finalEl.textContent = finalText;

    const champEl = document.getElementById("champion");
    if (champEl) champEl.textContent = championText;
  }).catch(err=>{
    console.error(err);
    const note = document.createElement('div');
    note.className = 'note';
    note.textContent = 'Could not load cup data. Please refresh.';
    document.body.appendChild(note);
  });
})();
</script>
</body>
</html>
